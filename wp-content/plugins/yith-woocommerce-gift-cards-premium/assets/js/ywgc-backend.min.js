jQuery(document).ready(function(e){function t(t){var a={action:"add_gift_card_amount",amount:e("#gift_card-amount").val(),product_id:e("#post_ID").val()},o=t.closest("span.add-new-amount-section");o.block({message:null,overlayCSS:{background:"#fff url("+ywgc_data.loader+") no-repeat center",opacity:.6}}),e.post(ywgc_data.ajax_url,a,function(t){1==t.code&&e("p._gift_card_amount_field").replaceWith(t.value),e("#gift_card-amount").val(""),e("#gift_card-amount").selectionStart=0,e("#gift_card-amount").selectionEnd=0,e("#gift_card-amount").focus(),o.unblock()})}e(document).on("click","a.remove-amount",function(t){t.preventDefault();var a={action:"remove_gift_card_amount",amount:e(this).closest("span.variation-amount").find('input[name="gift-card-amounts[]"]').val(),product_id:e("#post_ID").val()},o=e(this).closest("span.variation-amount");o.block({message:null,overlayCSS:{background:"#fff url("+ywgc_data.loader+") no-repeat center",opacity:.6}}),e.post(ywgc_data.ajax_url,a,function(e){1==e.code&&o.remove(),o.unblock()})}),e(document).on("click","a.add-new-amount",function(a){a.preventDefault(),t(e(this))}),e(document).on("keypress","input#gift_card-amount",function(a){13===event.which&&(a.preventDefault(),e(this).attr("disabled","disabled"),t(e(this)),e(this).removeAttr("disabled"))}),e(document).on("change",'input[name="ywgc_physical_gift_card"]',function(t){var a=e(this).prop("checked");e('input[name="_virtual"]').prop("checked",!a)}),e(document).on("click",".image-gallery-reset",function(t){t.preventDefault(),e("#ywgc-card-header-image img").remove(),e("#ywgc_product_image_id").val(0)}),e(document).on("click",".image-gallery-chosen",function(t){t.preventDefault();var a,o=e(this).attr("name")+"_id";if(a)a.open();else{var n=[new wp.media.controller.Library({library:wp.media.query(),multiple:!1,title:ywgc_data.choose_image_text,priority:20,filterable:"uploaded"})];(a=wp.media.frames.downloadable_file=wp.media({title:ywgc_data.choose_image_text,library:{type:""},button:{text:ywgc_data.choose_image_text},multiple:!1,states:n})).on("select",function(){e("#ywgc-card-header-image img").remove();var t=a.state().get("selection").first().toJSON();e("#ywgc-card-header-image").prepend('<img width="80" src="'+t.url+'" />'),e("#"+o).val(t.id),e(".plugin-option .upload_img_url").trigger("change")}),a.open()}}),e("body .ywgc_order_sold_as_gift_card").each(function(){e(this).parent("td").find(".wc-order-item-name").hide()}),e("._manage_stock_field").addClass("show_if_gift-card").show(),void 0!==jQuery.fn.datepicker&&e(".ywgc-expiration-date-picker").datepicker({dateFormat:ywgc_data.date_format,minDate:1,maxDate:"+1Y"});var a=e("button#ywgc_direct_link_button:first").text();e(document).on("click","button#ywgc_direct_link_button",function(t){t.preventDefault();var o=e(this),n=o.prev("#ywgc_direct_link").text(),c=e("<input>");e("body").append(c),c.val(n).select(),document.execCommand("copy"),c.remove();var i=e("#ywgc_copied_to_clipboard").text();o.text(i),setTimeout(function(){o.text(a)},1e3)}),e(document).on("change",".ywgc-toggle-enabled input",function(){var t="yes"===e(this).val()?"yes":"no",a=e(this).closest(".ywgc-toggle-enabled"),o=a.data("gift-card-id");a.block({message:null,overlayCSS:{background:"#fff",opacity:.7},ignoreIfBlocked:!0}),e.ajax({type:"POST",data:{action:"ywgc_toggle_enabled_action",id:o,enabled:t},url:ajaxurl,success:function(e){void 0!==e.error&&alert(e.error)},complete:function(){a.unblock()}})})});
