!function(e){if("undefined"!=typeof ywgc_data){var t=e("div.yith-ywgc-gift-this-product-form-container");e(document).on("click",".ywgc-choose-image.ywgc-choose-template",function(t){t.preventDefault(),e("#yith-ywgc .yith-ywgc-popup-close").show()}),e(document).on("ywgc-picture-changed",function(t,a,c){e(".ywgc-template-design").remove(),e(".ywgc-design-type").remove(),"custom"==c&&(a="custom"),"custom-modal"==c&&(a="custom-modal"),e("form.cart").append('<input type="hidden" class="ywgc-design-type" name="ywgc-design-type" value="'+a+'">'),e("form.cart").append('<input type="hidden" class="ywgc-template-design" name="ywgc-template-design" value="'+c+'">')}),e(document).ready(function(){e(".datepicker").datepicker({dateFormat:ywgc_data.date_format,minDate:1,maxDate:"+1Y"}),e(".ywgc-choose-design-preview .ywgc-design-list li:first-child .ywgc-preset-image img").click(),ywgc_data.gift_this_product_automatically&&e("a#give-as-present").click()}),w();var a=e(".product-type-gift-card .woocommerce-product-gallery__image a"),c=e(".product-type-gift-card .woocommerce-product-gallery__image--placeholder");e(".ywgc-preset-image.ywgc-default-product-image img").addClass("selected_design_image"),e(document).on("click","form.gift-cards_form.cart .ywgc-preset-image img",function(t){t.preventDefault();var a=e(this).parent().data("design-id");if(e(document).trigger("ywgc-picture-changed",["template",a]),e("a.lightbox-added").remove(),0!=e(".woocommerce-product-gallery__wrapper").children().length){e(".woocommerce-product-gallery__image").remove();var i=e(this).parent().data("design-url"),n=e(this).attr("srcset"),s=e(this).attr("src");(e(this).hasClass("custom-selected-image")||e(this).hasClass("custom-modal-selected-image"))&&(i=s),0!=c.length&&c.remove(),e('<div data-thumb="'+s+'" data-thumb-alt class="woocommerce-product-gallery__image"><a href="'+i+'"><img src="'+i+'" class="wp-post-image size-full" alt="" data-caption="" data-src="'+i+'" data-large_image="'+i+'" data-large_image_width="1024" data-large_image_height="1024" sizes="(max-width: 600px) 100vw, 600px"'+n+' width="600" height="600"></a></div>').insertBefore(".ywgc-main-form-preview-container")}}),e(document).on("click",".ywgc-preset-image img",function(t){t.preventDefault();var a=e(this).parent().data("design-id");e(".ywgc-preset-image img").removeClass("selected_design_image"),e(".ywgc-preset-image").removeClass("selected_image_parent"),e(this).addClass("selected_design_image"),e(this).parent().addClass("selected_image_parent"),e(document).trigger("ywgc-picture-changed",["template",a])}),e(document).on("yith_ywgc_popup_template_loaded",function(t,c){e(c).on("click","a.ywgc-show-category",function(t){var a=e(this).data("category-id");return e("a.ywgc-show-category").removeClass("ywgc-category-selected"),e(this).addClass("ywgc-category-selected"),"all"!==a?(e(".ywgc-design-item").hide(),e(".ywgc-design-item."+a).fadeIn("fast")):e(".ywgc-design-item").fadeIn("fast"),!1}),e(c).on("click",".ywgc-preset-image img",function(t){if(t.preventDefault(),e(".ywgc-preset-image img").removeClass("selected_design_image"),e(this).addClass("selected_design_image"),e(this).hasClass("selected_design_image")){var c=e(this).attr("src"),i=(e(this).attr("srcset"),e(this).parent().data("design-id")),n=e(this).parent().data("design-url"),s='<a href="'+c+'"><img src="'+c+'" class="wp-post-image size-thumbnail" alt="" data-caption="" data-src="'+c+'" data-large_image="'+c+'" data-large_image_width="1024" data-large_image_height="1024" sizes="(max-width: 600px) 100vw, 600px" width="600" height="600"></a>',r='<img src="'+c+'" class="attachment-thumbnail size-thumbnail selected_design_image selected_design_image_in_modal" alt="" sizes="(max-width: 150px) 85vw, 150px" width="150" height="150">';e(".ywgc-design-list li:first-child .ywgc-preset-image ").hasClass("ywgc-default-product-image")?(a.html(s),e(".ywgc-design-list li:nth-child(2) .ywgc-preset-image").html(r),e(".ywgc-design-list li:nth-child(2) .ywgc-preset-image").data("design-id",i),e(".ywgc-design-list li:nth-child(2) .ywgc-preset-image").data("design-url",n)):(e(".ywgc-design-list li:first-child .ywgc-preset-image").html(r),e(".ywgc-design-list li:first-child .ywgc-preset-image").data("design-id",i),e(".ywgc-design-list li:first-child .ywgc-preset-image").data("design-url",n))}e(".yith-ywgc-popup-wrapper .yith-ywgc-popup-close").click()}),e(c).on("click",".ywgc-upload-section-modal",function(t){t.preventDefault(),e(".ywgc-design-list-modal").hide(),e(".ywgc-custom-upload-container-modal").show()}),e(c).on("click",".ywgc-show-category",function(t){t.preventDefault(),e(".ywgc-custom-upload-container-modal").hide(),e(".ywgc-design-list-modal").show()}),e(c).on("click",".ywgc-custom-image-modal-submit-link",function(t){t.preventDefault(),e("body .ywgc-preset-image img").removeClass("selected_design_image");var c=e(this).parent().find("img.qq-thumbnail-selector").attr("src"),i='<img src="'+c+'" class="wp-post-image size-full" alt="" width="600" height="600">',n='<img src="'+c+'" class="attachment-thumbnail size-thumbnail custom-modal-selected-image selected_design_image selected_design_image_in_modal" alt="" srcset="'+c+" 150w, "+c+" 250w, "+c+' 100w" sizes="(max-width: 150px) 85vw, 150px" width="150" height="150">';e(".ywgc-design-list li:first-child .ywgc-preset-image ").hasClass("ywgc-default-product-image")?(e(".ywgc-design-list li:nth-child(2) .ywgc-preset-image").html(n),a.html(i)):e(".ywgc-design-list li:first-child .ywgc-preset-image").html(n),e(".ywgc-design-list .ywgc-preset-image img.custom-modal-selected-image").parent().attr("data-design-url",c),e(".ywgc-design-list .ywgc-preset-image img.custom-modal-selected-image").parent().attr("data-design-id","custom-modal"),e("form.cart").append('<input type="hidden" class="ywgc-custom-modal-design" name="ywgc-custom-modal-design" value="'+c+'">'),e(".yith-ywgc-popup-wrapper .yith-ywgc-popup-close").click()})}),e(document).on("yith_ywgc_popup_closed",function(t,a){e(".ywgc-design-list .ywgc-preset-image img.selected_design_image_in_modal").click()}),e(document).on("click",".ywgc-custom-picture",function(t){t.preventDefault(),e("#ywgc-upload-picture").click()}),e("#ywgc-upload-picture").on("change",function(){e(".ywgc-preset-image img").removeClass("selected_design_image");e(".ywgc-picture-error").remove();var t,c,i=e(this).val().split(".").pop().toLowerCase();-1!=e.inArray(i,["gif","png","jpg","jpeg","bmp"])?e(this)[0].files[0].size>1024*ywgc_data.custom_image_max_size*1024&&ywgc_data.custom_image_max_size>0?e("div.gift-card-content-editor.step-appearance").append('<span class="ywgc-picture-error">'+ywgc_data.invalid_image_size+"</span>"):(t=e(this)[0].files[0],(c=new FileReader).readAsDataURL(t),c.onload=function(t){var c=t.target.result,i='<img src="'+c+'" class="attachment-thumbnail size-thumbnail  custom-selected-image selected_design_image" alt="" srcset="'+c+" 150w, "+c+" 250w, "+c+' 100w" sizes="(max-width: 150px) 85vw, 150px" width="150" height="150">',n='<img src="'+c+'" class="wp-post-image size-full" alt="" width="600" height="600">';e(".ywgc-design-list li:first-child .ywgc-preset-image ").hasClass("ywgc-default-product-image")?(e(".ywgc-design-list li:nth-child(2) .ywgc-preset-image").html(i),a.html(n)):e(".ywgc-design-list li:first-child .ywgc-preset-image").html(i),e(".ywgc-design-list .ywgc-preset-image img.custom-selected-image").parent().attr("data-design-url",c),e(".ywgc-design-list .ywgc-preset-image img.custom-selected-image").parent().attr("data-design-id","custom"),e(".custom-selected-image ").click(),e(document).trigger("ywgc-picture-changed",["custom","custom"])}):e("div.gift-card-content-editor.step-appearance").append('<span class="ywgc-picture-error">'+ywgc_data.invalid_image_extension+"</span>")}),e(document).on("click","a.ywgc-show-giftcard",function(){return e(".ywgc_enter_code").slideToggle(300,function(){e(".yith_wc_gift_card_blank_brightness").length||(e(".ywgc_enter_code").find(":input:eq( 0 )").focus(),e(".ywgc_enter_code").keyup(function(t){13===t.keyCode&&e("button.ywgc_apply_gift_card_button").click()}))}),!1}),e("button.ywgc-do-edit").css("display","inline"),e(document).on("input",".gift-cards-list input.ywgc-manual-amount",function(e){w()}),e(document).on("input","#ywgc-edit-message",function(t){e(".ywgc-card-message").html(e("#ywgc-edit-message").val())}),e(document).on("change",".gift-cards-list select",function(e){w()}),e(document).on("click","a.customize-gift-card",function(t){t.preventDefault(),e("div.summary.entry-summary").after('<div class="ywgc-customizer"></div>')}),e(".yith-wcpb-product-bundled-items").length&&setTimeout(function(){e("#give-as-present").prop("disabled",!1)},1e3);var i=e("form.cart button.single_add_to_cart_button"),n=i.clone();n.removeAttr("type"),e(document).on("click","#give-as-present",function(a){a.preventDefault(),e("#give-as-present").attr("id","ywgc-cancel-gift-card"),e("#ywgc-cancel-gift-card span.dashicons").removeClass("dashicons-arrow-down-alt2"),e("#ywgc-cancel-gift-card span.dashicons").addClass("dashicons-arrow-up-alt2"),e("#ywgc-cancel-gift-card").css("display","inline-block"),e(".ywgc-design-list li:first-child .ywgc-preset-image img").click(),n.addClass("ywgc-add-gift-product-to-cart"),n.text(ywgc_data.add_gift_text),t.append(n),t.slideToggle("slow"),e(this).trigger("yith_ywgc_after_click_give_as_present")}),e(document).on("click","#ywgc-cancel-gift-card",function(a){a.preventDefault(),e("#ywgc-cancel-gift-card").attr("id","give-as-present"),e("#give-as-present span.dashicons").removeClass("dashicons-arrow-up-alt2"),e("#give-as-present span.dashicons").addClass("dashicons-arrow-down-alt2"),t.slideToggle("slow")}),e(document).on("click",".ywgc-add-gift-product-to-cart",function(a){a.preventDefault(),"1"==ywgc_data.mandatory_email&&e(".yith_wc_gift_card_input_recipient_details").prop("required",!0),t.append('<input type="hidden" class="ywgc-as-present" name="ywgc-as-present" value="1">'),i.click()}),e(".variations_form.cart").on("found_variation",function(t,a){void 0!==a&&(e("#give-as-present").prop("disabled",!1),_(""!=a.price_html?e(a.price_html).html():e(".product-type-variable").find(".woocommerce-Price-amount.amount").first().html()))}),e(document).on("reset_data",function(){e("#give-as-present").prop("disabled",!0),_("")}),e(document).on("click","button.ywgc-apply-edit",function(t){var a=e(this),c=a.closest("div.ywgc-gift-card-content"),i=c.find('input[name="ywgc-edit-sender"]').val(),n=c.find('input[name="ywgc-edit-recipient"]').val(),s=c.find('textarea[name="ywgc-edit-message"]').val(),r=c.find('input[name="ywgc-item-id"]').val(),d=c.find('input[name="ywgc-gift-card-id"]'),o=d.val();if(a.hasClass("apply")){var g={action:"edit_gift_card",gift_card_id:o,item_id:r,sender:i,recipient:n,message:s};c.block({message:null,overlayCSS:{background:"#fff url("+ywgc_data.loader+") no-repeat center",opacity:.6}}),e.post(ywgc_data.ajax_url,g,function(e){e.code>0&&(c.find("span.ywgc-sender").text(i),c.find("span.ywgc-recipient").text(n),c.find("span.ywgc-message").text(s),2==e.code&&d.val(e.values.new_id)),c.unblock(),f(a,!1)})}}),e(document).on("click","button.ywgc-cancel-edit",function(t){f(e(this),!1)}),e(document).on("click","button.ywgc-do-edit",function(t){f(e(this),!0)}),e(document).on("click",".ywgc-gift-card-content a.edit-details",function(t){t.preventDefault(),e(this).addClass("ywgc-hide"),e("div.ywgc-gift-card-details").toggleClass("ywgc-hide")}),e('.ywgc-single-recipient input[name="ywgc-recipient-email[]"]').each(function(t,a){e(this).on("input",function(){e(this).closest(".ywgc-single-recipient").find(".ywgc-bad-email-format").remove()})}),e(document).on("submit",".gift-cards_form",function(t){var a=!0;e('.ywgc-single-recipient input[name="ywgc-recipient-email[]"]').each(function(t,c){var i;e(this).val()&&(i=e(this).val(),!new RegExp("^[A-Z0-9._%+-]+@[A-Z0-9.-]+\\.[A-Z]{2,}$","i").test(i))&&(e(this).closest(".ywgc-single-recipient").find(".ywgc-bad-email-format").remove(),e(this).after('<span class="ywgc-bad-email-format">'+ywgc_data.email_bad_format+"</span>"),a=!1)}),a||t.preventDefault()}),e(document).on("click","a.ywgc-remove-gift-card ",function(t){t.preventDefault();var a=e(t.currentTarget).parents("table"),c=e(t.currentTarget).data("gift-card-code");s(a);var i={security:ywgc_data.gift_card_nonce,code:c,action:"ywgc_remove_gift_card_code"};e.ajax({type:"POST",url:ywgc_data.ajax_url,data:i,dataType:"html",success:function(t){o(t),e(document.body).trigger("removed_gift_card"),r(a)},complete:function(){h()}})}),e(document).on("click","button.ywgc_apply_gift_card_button",function(t){t.preventDefault();var a=e(this).closest("div.ywgc_enter_code");s(a);var c=a.find('input[ name="gift_card_code" ]'),i=c.val(),n={security:ywgc_data.gift_card_nonce,code:i,action:"ywgc_apply_gift_card_code"};e.ajax({type:"POST",url:ywgc_data.ajax_url,data:n,dataType:"html",success:function(t){o(t),e(document.body).trigger("applied_gift_card")},complete:function(){r(a),c.val(""),h()}})});var s=function(e){e.addClass("processing").block({message:null,overlayCSS:{background:"#fff",opacity:.6}})},r=function(e){e.removeClass("processing").unblock()},d=function(e){return ywgc_data.wc_ajax_url.toString().replace("%%endpoint%%",e)},o=function(t){e(".woocommerce-error, .woocommerce-message").remove(),e(ywgc_data.notice_target).after(t),e(".ywgc_have_code").length&&e(".ywgc_enter_code").slideUp("300")};e(document).on("qv_loader_stop yit_quick_view_loaded flatsome_quickview",function(){w(),g()});var g=function(){e('input[name="ywgc-as-present-enabled"]').length&&(e(".ywgc-generator").hide(),p(!1))};e(document).on("click","button.yith-add-new-gc-my-account-button",function(t){t.preventDefault(),e(this).parent().prev(".form-link-gift-card-to-user").toggle("slow")});var l=e(".ywgc-recipient-name input");l.on("change keyup",function(t){t.preventDefault();var a=l.val();e(".ywgc-form-preview-to-content").text(a)});var m=e(".ywgc-sender-name input");m.on("change keyup",function(t){t.preventDefault();var a=m.val();e(".ywgc-form-preview-from-content").text(a)});var u=e(".ywgc-message textarea");u.on("change keyup",function(t){t.preventDefault();var a=u.val();e(".ywgc-form-preview-message").html(a.replace(/\n/g,"<br/>"))}),e(document).on("click","a.add-recipient",function(t){t.preventDefault();var a=e(".ywgc-additional-recipient").length,c=e(".product-qty-arrows");c.length&&c.hide(),function(t){var a=t+2,c=e("div.gift_card_template_button input[name='quantity']"),i=ywgc_data.multiple_recipient.replace("%number_gift_cards%",a),n=e("div.ywgc-single-recipient").last(),s=ywgc_data.mandatory_email?"required":"",r='<div class="ywgc-additional-recipient"><label for="ywgc-recipient-name'+t+'">'+ywgc_data.label_name+'</label><input type="text" id="ywgc-recipient-name'+t+'" name="ywgc-recipient-name[]" class="yith_wc_gift_card_input_recipient_details" placeholder="'+ywgc_data.name+'" '+s+'/><br><label for="ywgc-recipient-email'+t+'">'+ywgc_data.label_email+'</label><input type="email" id="ywgc-recipient-email'+t+'" name="ywgc-recipient-email[]" class="ywgc-recipient yith_wc_gift_card_input_recipient_details" placeholder="'+ywgc_data.email+'" '+s+'/><a href="#" class="ywgc-remove-recipient"> </div>';n.after(r),e("a.ywgc-remove-recipient").not(":first").css("visibility","visible"),c.addClass("ywgc-remove-number-input"),c.attr("onkeydown","return false"),c.css("background-color","lightgray"),c.val(a),e(".ywgc-multi-recipients span").remove(),e("div.gift_card_template_button div.quantity").before("<div class='ywgc-multi-recipients'><span>"+i+"</span></div>")}(a)}),e(document).on("click","a.ywgc-remove-recipient",function(t){t.preventDefault();var a=e(".ywgc-additional-recipient").length,c=e(".product-qty-arrows");c.length&&"0"===a&&c.show(),function(t,a){var c=e("div.gift_card_template_button input[name='quantity']");c.val(a);var i=ywgc_data.multiple_recipient.replace("%number_gift_cards%",a);e(".ywgc-multi-recipients span").remove(),e("div.gift_card_template_button div.quantity").before("<div class='ywgc-multi-recipients'><span>"+i+"</span></div>"),e(t).parent("div.ywgc-additional-recipient").remove(),1==e('input[name="ywgc-recipient-email[]"]').length&&(e("a.hide-if-alone").css("visibility","hidden"),e("div.ywgc-multi-recipients").remove(),c.removeClass("ywgc-remove-number-input"),c.removeAttr("onkeydown"),c.css("background-color",""))}(e(this),a)})}function y(t){e(".ywgc-form-preview-amount").text(t)}function p(t){e("button.gift_card_add_to_cart_button").attr("disabled",!t)}function w(){var t=e("#give-as-present"),a=e("button.ywgc-amount-buttons"),c=e("input.ywgc-amount-buttons"),i=e(".gift-cards-list input.ywgc-manual-amount"),n=e("button.ywgc-amount-buttons:first");i.hasClass("selected_button")||(n.addClass("selected_button"),n.hasClass("selected_button")&&e("input.ywgc-amount-buttons:first").attr("name","gift_amounts"),e(".ywgc-form-preview-amount").text(n.data("wc-price"))),a.on("click",function(t){t.preventDefault(),a.removeClass("selected_button"),c.removeClass("selected_button"),c.removeAttr("name"),i.removeClass("selected_button"),e(this).addClass("selected_button"),e(this).next().addClass("selected_button")});var s=i.attr("placeholder");i.on("click change keyup",function(t){e(this).css("padding-left","25px"),e(this).css("text-align","left"),e(this).removeAttr("placeholder"),e(".ywgc-manual-currency-symbol").removeClass("ywgc-hidden"),e(".ywgc-manual-currency-symbol").addClass("ywgc-currency-symbol")}),i.on("focusout",function(t){0===i.val().length&&(e(this).css("padding-left","unset"),e(this).css("text-align","center"),e(this).attr("placeholder",s),e(".ywgc-manual-currency-symbol").removeClass("ywgc-currency-symbol"),e(".ywgc-manual-currency-symbol").addClass("ywgc-hidden"),n.click())}),i.on("click change keyup",function(t){if(t.preventDefault(),a.removeClass("selected_button"),c.removeClass("selected_button"),c.removeAttr("name"),null==ywgc_data.currency_format_symbol)var n=e(".ywgc-manual-currency-symbol").text();else n=ywgc_data.currency_format_symbol;if(e(".ywgc-form-preview-amount").text(e(this).data("wc-price")),e(this).addClass("selected_button"),i.length){e(".ywgc-manual-amount-error").remove(),e(this).removeClass("ywgc-red-border");var s=i.val(),d=new RegExp("^[1-9]\\d*(?:\\"+ywgc_data.currency_format_decimal_sep+"\\d{1,2})?$","g");s.length&&!d.test(s)?(e(".ywgc-manual-currency-symbol").after('<div class="ywgc-manual-amount-error">'+ywgc_data.manual_amount_wrong_format+"</div>"),e(this).addClass("ywgc-red-border"),y(r=accounting.formatMoney("",{symbol:n,decimal:ywgc_data.currency_format_decimal_sep,thousand:ywgc_data.currency_format_thousand_sep,precision:ywgc_data.currency_format_num_decimals,format:ywgc_data.currency_format})),p(!1)):parseInt(s)<parseInt(ywgc_data.manual_minimal_amount)&&ywgc_data.manual_minimal_amount_error.length>0?(e(".ywgc-manual-currency-symbol").after('<div class="ywgc-manual-amount-error">'+ywgc_data.manual_minimal_amount_error+"</div>"),e(this).addClass("ywgc-red-border"),y(r=accounting.formatMoney(s,{symbol:n,decimal:ywgc_data.currency_format_decimal_sep,thousand:ywgc_data.currency_format_thousand_sep,precision:ywgc_data.currency_format_num_decimals,format:ywgc_data.currency_format})),p(!1)):s?(p(!0),(r=accounting.unformat(s,ywgc_data.mon_decimal_point))<=0?p(!1):(y(r=accounting.formatMoney(r,{symbol:n,decimal:ywgc_data.currency_format_decimal_sep,thousand:ywgc_data.currency_format_thousand_sep,precision:ywgc_data.currency_format_num_decimals,format:ywgc_data.currency_format})),p(!0))):(y(r=accounting.formatMoney("",{symbol:n,decimal:ywgc_data.currency_format_decimal_sep,thousand:ywgc_data.currency_format_thousand_sep,precision:ywgc_data.currency_format_num_decimals,format:ywgc_data.currency_format})),p(!1))}});var r=n.data("wc-price");a.on("click",function(i){i.preventDefault(),c.removeAttr("name"),t.length||(e(".ywgc-manual-amount-error").remove(),a.data("price")?(p(!0),r=e("input.selected_button").data("wc-price"),e("input.selected_button").attr("name","gift_amounts")):p(!1),y(r))})}function _(t){e("div.ywgc-card-amount span.amount").html(t)}function f(t,a){var c=e(t).closest("div.ywgc-gift-card-content"),i=c.find("div.ywgc-gift-card-edit-details"),n=c.find("div.ywgc-gift-card-details");a?(i.removeClass("ywgc-hide"),i.addClass("ywgc-show"),n.removeClass("ywgc-show"),n.addClass("ywgc-hide")):(i.removeClass("ywgc-show"),i.addClass("ywgc-hide"),n.removeClass("ywgc-hide"),n.addClass("ywgc-show"))}function h(){s(e("div.cart_totals")),e.ajax({url:d("get_cart_totals"),dataType:"html",success:function(t){e("div.cart_totals").replaceWith(t)}}),e(document.body).trigger("update_checkout")}}(jQuery);
